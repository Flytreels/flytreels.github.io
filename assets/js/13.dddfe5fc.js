(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{414:function(d,t,s){"use strict";s.r(t);var a=s(10),r=Object(a.a)({},(function(){var d=this,t=d.$createElement,s=d._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":d.$parent.slotKey}},[s("blockquote",[s("p",[d._v("这种方法也同样适用于其他的发行版，比如Arch Debian等等")])]),d._v(" "),s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[d._v("#")]),d._v(" 前言")]),d._v(" "),s("p",[d._v("这里可能就会问道了，Termux不是有很多的安装Linux发行版的工具吗（proot-distro,anlinux等等），为什么还需要这样麻烦安装？"),s("br"),d._v("\n当然肯定有优势")]),d._v(" "),s("ul",[s("li",[d._v("[√] 从官方获取最小体积Rootfs")]),d._v(" "),s("li",[d._v("[√] 安全，快捷，更新迅速，方便后续扩展")]),d._v(" "),s("li",[d._v("[√] 不被第三方魔改或者加入风险")])]),d._v(" "),s("h2",{attrs:{id:"下载rootfs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载rootfs"}},[d._v("#")]),d._v(" 下载Rootfs")]),d._v(" "),s("p",[d._v("一般下载Rootfs都是从官方软件源或者镜像站或者LXC镜像站下载")]),d._v(" "),s("p",[d._v("这里下载alpine的rootfs只需要在官方镜像站就能下载到，有些发行版只能从lxc-images下载到（当然你也可使用各种Bootstrap工具去构建一个最新的）")]),d._v(" "),s("p",[s("a",{attrs:{href:"https://mirrors.bfsu.edu.cn/alpine/v3.14/releases/",target:"_blank",rel:"noopener noreferrer"}},[d._v("Alpine 3.14下载"),s("OutboundLink")],1),s("br"),d._v("\n一般情况顺藤摸瓜，看一下releases Rootfs images这类的文件夹")]),d._v(" "),s("p",[d._v("rootfs即根文件系统，一般情况以tar.gz或tar.xz格式打包，下载后需要解压到目标目录，大多情况为容器所使用，而我们在Termux上的chroot或者proot就都属于容器类型了，不能算是完整的系统，也没有真正模拟出一个计算机去运行发行版")]),d._v(" "),s("h2",{attrs:{id:"安装rootfs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装rootfs"}},[d._v("#")]),d._v(" 安装ROOTFS")]),d._v(" "),s("p",[d._v("使用wget命令下载rootfs"),s("br"),d._v("\n目录随意，别是内部存储或者SD卡就行"),s("br"),d._v(" "),s("img",{attrs:{src:"/Screenshot_20210822-113455.png",alt:"Image"}})]),d._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[d._v("wget https://mirrors.bfsu.edu.cn/alpine/v3.14/releases/aarch64/alpine-minirootfs-3.14.0_rc4-aarch64.tar.gz # 下载rootfs到当前目录\nmkdir alpine # 新建rootfs存放文件夹（名称随意）\nproot --link2symlink tar xzvf alpine-minirootfs-3.14.0_rc4-aarch64.tar.gz -C alpine # 解压rootfs，同时使用proot的link2symlink功能模拟硬链接（没ROOT使用此方法）\n")])])]),s("p",[d._v("执行之后就安装到alpine文件夹辣！")]),d._v(" "),s("h2",{attrs:{id:"启动容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[d._v("#")]),d._v(" 启动容器")]),d._v(" "),s("p",[d._v("同时启动容器也非常简单，你也可以把他写进一个sh文件或者.bashrc让他在termux自启")]),d._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[d._v("unset LD_PRELOAD\nproot -b /sys -b /proc -b /dev -r ./alpine/ --sysvipc --link2symlink -0 -w /root /bin/ash -l\n")])])]),s("p",[d._v("执行上述命令就能启动容器内的shell")]),d._v(" "),s("table",[s("thead",[s("tr",[s("th",[d._v("参数")]),d._v(" "),s("th",[d._v("解释")])])]),d._v(" "),s("tbody",[s("tr",[s("td",[d._v("-b")]),d._v(" "),s("td",[d._v("挂载目录")])]),d._v(" "),s("tr",[s("td",[d._v("-r")]),d._v(" "),s("td",[d._v("指定Rootfs目录")])]),d._v(" "),s("tr",[s("td",[d._v("--sysvipc")]),d._v(" "),s("td",[d._v("在 proot 中处理 System V IPC 系统调用")])]),d._v(" "),s("tr",[s("td",[d._v("--link2symlink")]),d._v(" "),s("td",[d._v("用符号链接替换硬链接，假装它们真的是硬链接")])]),d._v(" "),s("tr",[s("td",[d._v("-0")]),d._v(" "),s("td",[d._v("模拟ROOT权限")])]),d._v(" "),s("tr",[s("td",[d._v("-w")]),d._v(" "),s("td",[d._v("设置初始目录")])]),d._v(" "),s("tr",[s("td",[d._v("/bin/ash -l")]),d._v(" "),s("td",[d._v("将ash作为进入容器环境后执行的第一个程序")])])])]),d._v(" "),s("blockquote",[s("p",[d._v("挂载 /proc /dev 是必须的，否则容器内的大多数程序都无法正常工作！")])]),d._v(" "),s("h2",{attrs:{id:"基本配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基本配置"}},[d._v("#")]),d._v(" 基本配置")]),d._v(" "),s("p",[d._v("一般默认的rootfs都是最基本的没有任何配置过的，一般需要配置DNS和软件源即可\n使用以下命令即可配置DNS为 8.8.8.8的谷歌DNS")]),d._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[d._v('echo "nameserver 8.8.8.8">/etc/resolv.conf\n')])])]),s("p",[d._v("软件源大多官方Wiki都有")]),d._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[d._v("localhost:~# neofetch\n       .hddddddddddddddddddddddh.          root@localhost\n      :dddddddddddddddddddddddddd:         ----------------\n     /dddddddddddddddddddddddddddd/        OS: Alpine Linux v3.14 aarch64\n    +dddddddddddddddddddddddddddddd+       Kernel: 5.10.56-lineageos\n  `sdddddddddddddddddddddddddddddddds`     Uptime: 357 day, 12 hours, 48 mins\n `ydddddddddddd++hdddddddddddddddddddy`    Packages: 19 (apk)\n.hddddddddddd+`  `+ddddh:-sdddddddddddh.   Shell: ash\nhdddddddddd+`      `+y:    .sddddddddddh   Terminal: proot\nddddddddh+`   `//`   `.`     -sddddddddd   CPU: Qualcomm MSM 8939 (8) @ 3.497GH\nddddddh+`   `/hddh/`   `:s-    -sddddddd   Memory: 1456MiB / 16500MiB\nddddh+`   `/+/dddddh/`   `+s-    -sddddd\nddd+`   `/o` :dddddddh/`   `oy-    .yddd\nhdddyo+ohddyosdddddddddho+oydddy++ohdddh\n.hddddddddddddddddddddddddddddddddddddh.\n `yddddddddddddddddddddddddddddddddddy`\n  `sdddddddddddddddddddddddddddddddds`\n    +dddddddddddddddddddddddddddddd+\n     /dddddddddddddddddddddddddddd/\n      :dddddddddddddddddddddddddd:\n       .hddddddddddddddddddddddh.\n\nlocalhost:~#\n")])])]),s("blockquote",[s("p",[d._v("总体来说这种方法还不错，6条命令一键式安装，关键是步骤非常详细能了解全部的用途")])]),d._v(" "),s("h2",{attrs:{id:"the-end"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#the-end"}},[d._v("#")]),d._v(" The end")])])}),[],!1,null,null,null);t.default=r.exports}}]);